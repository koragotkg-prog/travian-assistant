<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Travian Assistant</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>

  <div class="popup">

    <!-- ═══ HEADER ═══ -->
    <header class="hdr">
      <div class="hdr-brand">
        <svg class="hdr-logo" viewBox="0 0 24 24" width="18" height="18">
          <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span class="hdr-title">TRAVIAN CTRL</span>
      </div>
      <div class="hdr-right">
        <span class="hdr-server" id="serverLabel">--</span>
        <div class="hdr-dot" id="statusDot"></div>
      </div>
    </header>

    <!-- ═══ HERO STATUS ═══ -->
    <section class="hero" id="heroSection">
      <div class="hero-state" id="heroState">OFFLINE</div>
      <div class="hero-cycle" id="heroCycle">--</div>
      <div class="hero-task" id="heroTask">No active task</div>
      <div class="hero-ai" id="heroAI"></div>
    </section>

    <!-- ═══ ERROR BANNER (hidden by default) ═══ -->
    <div class="err-banner hidden" id="errBanner">
      <svg viewBox="0 0 24 24" width="14" height="14"><path d="M12 9v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      <span id="errText"></span>
    </div>

    <!-- ═══ RESOURCE BARS ═══ -->
    <section class="res-section">
      <div class="res-row" data-res="wood">
        <span class="res-icon">W</span>
        <div class="res-track"><div class="res-fill" id="barWood"></div></div>
        <span class="res-pct" id="pctWood">--%</span>
        <span class="res-prod" id="prodWood">--</span>
      </div>
      <div class="res-row" data-res="clay">
        <span class="res-icon">C</span>
        <div class="res-track"><div class="res-fill" id="barClay"></div></div>
        <span class="res-pct" id="pctClay">--%</span>
        <span class="res-prod" id="prodClay">--</span>
      </div>
      <div class="res-row" data-res="iron">
        <span class="res-icon">I</span>
        <div class="res-track"><div class="res-fill" id="barIron"></div></div>
        <span class="res-pct" id="pctIron">--%</span>
        <span class="res-prod" id="prodIron">--</span>
      </div>
      <div class="res-row" data-res="crop">
        <span class="res-icon">K</span>
        <div class="res-track"><div class="res-fill" id="barCrop"></div></div>
        <span class="res-pct" id="pctCrop">--%</span>
        <span class="res-prod" id="prodCrop">--</span>
      </div>
    </section>

    <!-- ═══ STATS STRIP ═══ -->
    <section class="stats-strip">
      <div class="stat-cell">
        <span class="stat-num" id="statTasks">0</span>
        <span class="stat-lbl">DONE</span>
      </div>
      <div class="stat-div"></div>
      <div class="stat-cell">
        <span class="stat-num" id="statFarms">0</span>
        <span class="stat-lbl">FARMS</span>
      </div>
      <div class="stat-div"></div>
      <div class="stat-cell">
        <span class="stat-num" id="statQueue">0</span>
        <span class="stat-lbl">QUEUE</span>
      </div>
      <div class="stat-div"></div>
      <div class="stat-cell">
        <span class="stat-num" id="statUptime">--</span>
        <span class="stat-lbl">UP</span>
      </div>
    </section>

    <!-- ═══ NEXT ACTION ═══ -->
    <section class="next-action">
      <span class="next-label">NEXT</span>
      <span class="next-task" id="nextTask">--</span>
      <span class="next-timer" id="nextTimer">--:--</span>
    </section>

    <!-- ═══ CONTROLS ═══ -->
    <section class="ctrl-bar">
      <button class="ctrl-btn ctrl--start" id="btnStart" title="Start">
        <svg viewBox="0 0 24 24" width="16" height="16"><polygon points="6,4 20,12 6,20" fill="currentColor"/></svg>
        <span>Start</span>
      </button>
      <button class="ctrl-btn ctrl--pause hidden" id="btnPause" title="Pause">
        <svg viewBox="0 0 24 24" width="16" height="16"><rect x="5" y="4" width="4" height="16" rx="1" fill="currentColor"/><rect x="15" y="4" width="4" height="16" rx="1" fill="currentColor"/></svg>
        <span>Pause</span>
      </button>
      <button class="ctrl-btn ctrl--resume hidden" id="btnResume" title="Resume">
        <svg viewBox="0 0 24 24" width="16" height="16"><polygon points="6,4 20,12 6,20" fill="currentColor"/></svg>
        <span>Resume</span>
      </button>
      <button class="ctrl-btn ctrl--stop hidden" id="btnStop" title="Stop">
        <svg viewBox="0 0 24 24" width="16" height="16"><rect x="5" y="5" width="14" height="14" rx="2" fill="currentColor"/></svg>
        <span>Stop</span>
      </button>
      <button class="ctrl-btn ctrl--emg" id="btnEmergency" title="Emergency Stop">
        <svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 9v4m0 4h.01M12 3l9.5 16.5H2.5L12 3z" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
    </section>

    <!-- ═══ FOOTER ═══ -->
    <footer class="ftr">
      <button class="ftr-btn" id="btnDashboard">
        <svg viewBox="0 0 24 24" width="14" height="14"><rect x="3" y="3" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="2"/><rect x="14" y="3" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="2"/><rect x="3" y="14" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="2"/><rect x="14" y="14" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="2"/></svg>
        Open Dashboard
        <svg viewBox="0 0 24 24" width="12" height="12"><path d="M7 17l9.2-9.2M17 17V8H8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
    </footer>

  </div>

  <script src="../shared/constants.js"></script>
  <script src="../shared/formatters.js"></script>
  <script src="../shared/ui-client.js"></script>
  <script src="popup.js"></script>
</body>
</html>
